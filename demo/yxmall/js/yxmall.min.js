/*! xo v1.0.0 - 12/13/2013
   http://oxox.io/xo
   Copyright (c) 2013 oxox.io - Licensed MIT */
XO.Controller.define("home",{index:function(a){this.renderView("index",{param:a,onRendered:function(){},data:function(a,b){var c={hi:1};b(null,c)}})},baby:function(a){this.renderView("baby",{param:a,data:{staticData:!0}})}}),XO.View.define({pid:"home",vid:"index",version:"20131212",init:function(){XO.warn("View inited:"+this.id)},onRender:function(){XO.warn(XO.View.getId(this.pid,this.vid)+":View onRender",this)},onAnimating:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimating",a)},onAnimated:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimated",a),this.swipPager||(this.$el.swipePager({onPrev:function(){var a=window.J_navslide_obj.goPrev().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)},onNext:function(){var a=window.J_navslide_obj.goNext().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)}}),this.swipePager=!0)}}),XO.View.define({pid:"home",vid:"baby",version:"20131212",init:function(){XO.warn("View inited:"+this.id)},onRender:function(){XO.warn(XO.View.getId(this.pid,this.vid)+":View onRender",this)},onAnimating:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimating",a)},onAnimated:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimated",a),this.swipPager||(this.$el.swipePager({onPrev:function(){var a=window.J_navslide_obj.goPrev().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)},onNext:function(){var a=window.J_navslide_obj.goNext().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)}}),this.swipePager=!0)}}),XO.View.define({pid:"home",vid:"daily",version:"20131212",init:function(){XO.warn("View inited:"+this.id)},onRender:function(){XO.warn(XO.View.getId(this.pid,this.vid)+":View onRender",this)},onAnimating:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimating",a)},onAnimated:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimated",a),this.swipPager||(this.$el.swipePager({onPrev:function(){var a=window.J_navslide_obj.goPrev().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)},onNext:function(){var a=window.J_navslide_obj.goNext().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)}}),this.swipePager=!0)}}),XO.View.define({pid:"home",vid:"faxian",version:"20131212",init:function(){XO.warn("View inited:"+this.id)},onRender:function(){XO.warn(XO.View.getId(this.pid,this.vid)+":View onRender",this)},onAnimating:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimating",a)},onAnimated:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimated",a),this.swipPager||(this.$el.swipePager({onPrev:function(){var a=window.J_navslide_obj.goPrev().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)},onNext:function(){var a=window.J_navslide_obj.goNext().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)}}),this.swipePager=!0)}}),XO.View.define({pid:"home",vid:"guang",version:"20131212",init:function(){XO.warn("View inited:"+this.id)},onRender:function(){XO.warn(XO.View.getId(this.pid,this.vid)+":View onRender",this)},onAnimating:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimating",a)},onAnimated:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimated",a),this.swipPager||(this.$el.swipePager({onPrev:function(){var a=window.J_navslide_obj.goPrev().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)},onNext:function(){var a=window.J_navslide_obj.goNext().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)}}),this.swipePager=!0)}}),XO.View.define({pid:"home",vid:"pinpai",version:"20131212",init:function(){XO.warn("View inited:"+this.id)},onRender:function(){XO.warn(XO.View.getId(this.pid,this.vid)+":View onRender",this)},onAnimating:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimating",a)},onAnimated:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimated",a),this.swipPager||(this.$el.swipePager({onPrev:function(){var a=window.J_navslide_obj.goPrev().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)},onNext:function(){var a=window.J_navslide_obj.goNext().getCurrentItem().find("a");XO.history.navigate(a[0].getAttribute("href").replace("#",""),!0)}}),this.swipePager=!0)}}),XO.Controller.define("search",{index:function(a){this.renderView("index",{param:a,onRendered:function(){},data:function(a,b){var c={hi:1};b(null,c)}})}}),XO.View.define({pid:"search",vid:"index",version:"20131212",init:function(){XO.warn("View inited:"+this.id)},onRender:function(){XO.warn(XO.View.getId(this.pid,this.vid)+":View onRender",this)},onAnimating:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimating",a)},onAnimated:function(a){XO.warn(XO.View.getId(this.pid,this.vid)+":View onAnimated",a)}}),XO.View.define({pid:"common",vid:"search",alias:"uiSearch",dir:null,isLoading:!1,onRender:function(){$("#J_mod_nav_search").on("click",function(){return XO.View.uiSearch.toggle(),!1}),this.$ipt=$("#J_mod_search_ipt").on("blur",function(){XO.View.uiSearch.hide(function(){XO.history.navigate("page/search",!0)})}),$("#J_mod_search_bg").on("click",function(){XO.View.uiSearch.hide()})},toggle:function(){this.isLoading?this.hide():this.show()},show:function(){this.isLoading||(this.isLoading=!0,this.$el.removeClass(XO.CONST.CLASS.HIDE),this.$elbd||(this.$elbd=this.$el.find(".mod_search_bd")),setTimeout(function(){XO.View.uiSearch.$elbd.addClass(XO.CONST.CLASS.UIACTIVE),$("#J_mod_search_ipt").focus()},0))},hide:function(a){this.$elbd.one("webkitTransitionEnd",function(){XO.View.uiSearch.$el.addClass(XO.CONST.CLASS.HIDE),XO.View.uiSearch.isLoading=!1,a&&a()}).removeClass(XO.CONST.CLASS.UIACTIVE),this.$ipt.val("")}}),function(a){a.fn.outerWidth=function(){var a=this.width();return a+=parseFloat(this.css("margin-left").replace("px",""))||0,a+=parseFloat(this.css("margin-right").replace("px",""))||0,a+=parseFloat(this.css("padding-left").replace("px",""))||0,a+=parseFloat(this.css("padding-right").replace("px",""))||0},a.fn.navSlide=function(b){return 0==this.length?this:(this.each(function(){window[this.id+"_obj"]=new a.NavSlide(a(this),b)}),void 0)},a.NavSlide=function(b,c){this.container=a(b),this.nav=this.container.children().eq(0),this.posX=0,this.items=this.nav.children(),this.options=a.extend(!0,{},a.NavSlide.defaults,c),this._init()},a.NavSlide.prototype={_init:function(){var b=0,c=this.options,d=this._getItemIndexByHash();a.each(this.items,function(){b+=a(this).outerWidth()}),this.nav.width(b),c.useAnimation&&this.nav.css({"-webkit-transition-duration":c.duration+"ms"}),this.isTouch="ontouchstart"in window,this.viewPos={},this.viewPos.x=this.container.offset().left,this.viewPos.y=this.viewPos.x+this.container.outerWidth(),this.index=0,this.setCurrent(null===d?this.options.index:d),this._bindEvent()},_getItemIndexByHash:function(){var a=window.location.hash,b=null;return this.items.each(function(c,d){return-1!==a.indexOf(d.firstChild.getAttribute("href").replace("#",""))?(b=c,!1):void 0}),b},_bindEvent:function(){var b=this.isTouch;touchstart=b?"touchstart":"mousedown",touchmove=b?"touchmove":"mousemove",touchend=b?"touchend":"mouseup",me=this,this.items.on("click",function(){if(!a(this).hasClass(me.options.currentCls)){var b=a(this).index(this.items);me.setCurrent(b)}}),this.options.swipe&&(this.nav.bind(touchstart,function(a){me._touchstart(a)}),this.nav.bind(touchmove,function(a){me._touchmove(a)}),this.nav.bind(touchend,function(a){me._touchend(a)}))},_touchstart:function(a){var b=this.isTouch?a.touches[0]:a;this.started=!0,this.startX=b.pageX,this.startY=b.pageY},_touchmove:function(a){if(!(a.touches&&a.touches.length>1||a.scale&&1!==a.scale)&&this.started){var b=this.isTouch?a.touches[0]:a;return"undefined"==typeof this.isScrolling&&(this.isScrolling=Math.abs(b.pageX-this.startX)<Math.abs(b.pageY-this.startY)),this.isScrolling?(this.started=!1,void 0):(a.preventDefault(),void 0)}},_touchend:function(a){if(this.started){var b=this.isTouch?a.changedTouches[0]:a,c=b.pageX-this.startX;if(c>0){if(this.index==this.items.length-1)return;this.setCurrent(this.index-1)}else if(0>c){if(0==this.index)return;this.setCurrent(this.index+1)}}},goPrev:function(){var a=this.index-1;return 0>a?this:(this.setCurrent(a),this)},goNext:function(){var a=this.index+1;return a>=this.items.length?this:(this.setCurrent(a),this)},getCurrentItem:function(){return this.items.eq(this.index)},setCurrent:function(a){if(a!==this.index){(0>a||a>this.items.length-1)&&(a=0);var b=this.options.currentCls,c=this.index<a;this.items.eq(a).addClass(b).siblings().removeClass(b),this.index=a,this._adjustPos(c)}},_adjustPos:function(a){var b=this.items.eq(this.index);if(0==this.index)this.posX=0,this.nav.css({"-webkit-transform":"translate3d("+this.posX+"px,0,0)"});else if(this.index==this.items.length-1){var c=b.offset().left+b.outerWidth()-this.viewPos.y;c>0&&(this.posX-=c,this.nav.css({"-webkit-transform":"translate3d("+this.posX+"px,0,0)"}))}else if(a){b=b.next();var c=b.offset().left+b.outerWidth()-this.viewPos.y;c>0&&(this.posX-=c,this.nav.css({"-webkit-transform":"translate3d("+this.posX+"px,0,0)"}))}else{b=b.prev();var c=b.offset().left-this.viewPos.x;0>c&&(this.posX-=c,this.nav.css({"-webkit-transform":"translate3d("+this.posX+"px,0,0)"}))}}},a.NavSlide.defaults={currentCls:"current",index:0,useAnimation:!0,duration:300,swipe:!0}}(Zepto),function(a){a.fn.swipePager=function(b){return 0==this.length?this:(this.each(function(){new a.SwipePager(a(this),b)}),void 0)},a.SwipePager=function(b,c){this.container=a(b),this.options=a.extend(!0,{},a.SwipePager.defaults,c),this._init()},a.SwipePager.prototype={_init:function(){this.isTouch="ontouchstart"in window,this._bindEvent()},_bindEvent:function(){var a=this.isTouch;touchstart=a?"touchstart":"mousedown",touchmove=a?"touchmove":"mousemove",touchend=a?"touchend":"mouseup",self=this,this.container.on(touchstart,function(a){self._touchstart(a)}).on(touchmove,function(a){self._touchmove(a)}).on(touchend,function(a){self._touchend(a)})},_touchstart:function(a){var b=this.isTouch?a.touches[0]:a;this.started=!0,this.startX=b.pageX,this.startY=b.pageY},_touchmove:function(a){if(!(a.touches&&a.touches.length>1||a.scale&&1!==a.scale)&&this.started){var b=this.isTouch?a.touches[0]:a;return"undefined"==typeof this.isScrolling&&(this.isScrolling=Math.abs(b.pageX-this.startX)<Math.abs(b.pageY-this.startY)),this.isScrolling?(this.started=!1,void 0):(a.preventDefault(),void 0)}},_touchend:function(a){if(this.started){var b=this.isTouch?a.changedTouches[0]:a,c=b.pageX-this.startX;c>0?this.options.onPrev():0>c&&this.options.onNext()}}},a.SwipePager.defaults={onPrev:function(){},onNext:function(){}}}(Zepto);