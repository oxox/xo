/*! xo v1.0.0 - 12/25/2013
   http://oxox.io/xo
   Copyright (c) 2013 oxox.io - Licensed MIT */
function FastClick(a){"use strict";var b,c=this;if(this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=a,!a||!a.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return FastClick.prototype.onClick.apply(c,arguments)},this.onMouse=function(){return FastClick.prototype.onMouse.apply(c,arguments)},this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(c,arguments)},this.onTouchMove=function(){return FastClick.prototype.onTouchMove.apply(c,arguments)},this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(c,arguments)},this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(c,arguments)},FastClick.notNeeded(a)||(this.deviceIsAndroid&&(a.addEventListener("mouseover",this.onMouse,!0),a.addEventListener("mousedown",this.onMouse,!0),a.addEventListener("mouseup",this.onMouse,!0)),a.addEventListener("click",this.onClick,!0),a.addEventListener("touchstart",this.onTouchStart,!1),a.addEventListener("touchmove",this.onTouchMove,!1),a.addEventListener("touchend",this.onTouchEnd,!1),a.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(a.removeEventListener=function(b,c,d){var e=Node.prototype.removeEventListener;"click"===b?e.call(a,b,c.hijacked||c,d):e.call(a,b,c,d)},a.addEventListener=function(b,c,d){var e=Node.prototype.addEventListener;"click"===b?e.call(a,b,c.hijacked||(c.hijacked=function(a){a.propagationStopped||c(a)}),d):e.call(a,b,c,d)}),"function"==typeof a.onclick&&(b=a.onclick,a.addEventListener("click",function(a){b(a)},!1),a.onclick=null))}FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),FastClick.prototype.needsClick=function(a){"use strict";switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(this.deviceIsIOS&&"file"===a.type||a.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(a.className)},FastClick.prototype.needsFocus=function(a){"use strict";switch(a.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!this.deviceIsAndroid;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},FastClick.prototype.sendClick=function(a,b){"use strict";var c,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur(),d=b.changedTouches[0],c=document.createEvent("MouseEvents"),c.initMouseEvent(this.determineEventType(a),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),c.forwardedTouchEvent=!0,a.dispatchEvent(c)},FastClick.prototype.determineEventType=function(a){"use strict";return this.deviceIsAndroid&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(a){"use strict";var b;this.deviceIsIOS&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},FastClick.prototype.updateScrollParent=function(a){"use strict";var b,c;if(b=a.fastClickScrollParent,!b||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(a){"use strict";return a.nodeType===Node.TEXT_NODE?a.parentNode:a},FastClick.prototype.onTouchStart=function(a){"use strict";var b,c,d;if(a.targetTouches.length>1)return!0;if(b=this.getTargetElementFromEventTarget(a.target),c=a.targetTouches[0],this.deviceIsIOS){if(d=window.getSelection(),d.rangeCount&&!d.isCollapsed)return!0;if(!this.deviceIsIOS4){if(c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier,this.updateScrollParent(b)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=b,this.touchStartX=c.pageX,this.touchStartY=c.pageY,a.timeStamp-this.lastClickTime<200&&a.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(a){"use strict";var b=a.changedTouches[0],c=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c?!0:!1},FastClick.prototype.onTouchMove=function(a){"use strict";return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},FastClick.prototype.findControl=function(a){"use strict";return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(a){"use strict";var b,c,d,e,f,g=this.targetElement;if(!this.trackingClick)return!0;if(a.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;if(this.cancelNextClick=!1,this.lastClickTime=a.timeStamp,c=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,this.deviceIsIOSWithBadTarget&&(f=a.changedTouches[0],g=document.elementFromPoint(f.pageX-window.pageXOffset,f.pageY-window.pageYOffset)||g,g.fastClickScrollParent=this.targetElement.fastClickScrollParent),d=g.tagName.toLowerCase(),"label"===d){if(b=this.findControl(g)){if(this.focus(g),this.deviceIsAndroid)return!1;g=b}}else if(this.needsFocus(g))return a.timeStamp-c>100||this.deviceIsIOS&&window.top!==window&&"input"===d?(this.targetElement=null,!1):(this.focus(g),this.deviceIsIOS4&&"select"===d||(this.targetElement=null,a.preventDefault()),!1);return this.deviceIsIOS&&!this.deviceIsIOS4&&(e=g.fastClickScrollParent,e&&e.fastClickLastScrollTop!==e.scrollTop)?!0:(this.needsClick(g)||(a.preventDefault(),this.sendClick(g,a)),!1)},FastClick.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(a){"use strict";return this.targetElement?a.forwardedTouchEvent?!0:a.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0:!0:!0},FastClick.prototype.onClick=function(a){"use strict";var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===a.target.type&&0===a.detail?!0:(b=this.onMouse(a),b||(this.targetElement=null),b)},FastClick.prototype.destroy=function(){"use strict";var a=this.layer;this.deviceIsAndroid&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0)),a.removeEventListener("click",this.onClick,!0),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(a){"use strict";var b,c;if("undefined"==typeof window.ontouchstart)return!0;if(c=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!FastClick.prototype.deviceIsAndroid)return!0;if(b=document.querySelector("meta[name=viewport]")){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(c>31&&window.innerWidth<=window.screen.width)return!0}}return"none"===a.style.msTouchAction?!0:!1},FastClick.attach=function(a){"use strict";return new FastClick(a)},"undefined"!=typeof define&&define.amd?define(function(){"use strict";return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,function(a){if(!a)throw"Zepto or jQuery is required by XO!";window.XO=function(c,d){if(XO[c])return console.warn("Module with id ["+c+"] exists!"),void 0;var e={id:c};XO.EVENT[c]={},a.extend(e,b),d.call(e,a,XO.CONST),XO[c]=e,e=null},a.extend(XO,{$:a,version:"1.0.0",author:"http://oxox.io",$doc:a(document),$body:a(document.body),$win:a(window),EVENT:{},Base:{},LS:localStorage,toHtml:function(a,b,c){return a=XO.T.compile(a),a.render(b,c)},warn:function(a,b){return a="XO.JS:"+a,void 0!==window.console&&XO.App.opts.debug===!0&&console.warn(a,b),a},isExternalLink:function(a){return"_blank"===a.attr("target")||"external"===a.attr("rel")||a.is('a[href^="http://maps.google.com"], a[href^="mailto:"], a[href^="tel:"], a[href^="javascript:"], a[href*="youtube.com/v"], a[href*="youtube.com/watch"]')}});var b={exposeEvent:function(b){if(a.isArray(b))for(var c=0,d=b.length;d>c;c++)XO.EVENT[this.id][b[c]]="on"+this.id+b[c];else XO.EVENT[this.id][b]="on"+this.id+b},disposeEvent:function(a){XO.$body.off(XO.EVENT[this.id][a])},disposeAllEvents:function(){var a=XO.EVENT[this.id];for(var b in a)this.disposeEvent(b)},getLSKey:function(a){return["XO",this.id,a].join(".")}}}(window.Zepto||window.jQuery),function(a){var b={},c=Array.prototype,d=Object.prototype,e=Function.prototype,f=(c.push,c.slice),g=c.concat,h=d.toString,i=d.hasOwnProperty,j=c.forEach,k=c.map,l=(c.reduce,c.reduceRight,c.filter,c.every,c.some),m=(c.indexOf,c.lastIndexOf,Array.isArray),n=Object.keys,o=e.bind,p=0,q={};q.uniqueId=function(a){var b=++p+"";return a?a+b:b},q.identity=function(a){return a};{var r=q.each=q.forEach=function(a,c,d){if(null!=a)if(j&&a.forEach===j)a.forEach(c,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(c.call(d,a[e],e,a)===b)return}else for(var g=q.keys(a),e=0,f=g.length;f>e;e++)if(c.call(d,a[g[e]],g[e],a)===b)return};q.some=q.any=function(a,c,d){c||(c=q.identity);var e=!1;return null==a?e:l&&a.some===l?a.some(c,d):(r(a,function(a,f,g){return e||(e=c.call(d,a,f,g))?b:void 0}),!!e)}}q.map=q.collect=function(a,b,c){var d=[];return null==a?d:k&&a.map===k?a.map(b,c):(r(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)},q.result=function(a,b){if(null==a)return void 0;var c=a[b];return q.isFunction(c)?c.call(a):c},q.extend=function(a){return r(f.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},q.derive=function(a,b){var c,d=this;c=a&&q.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},q.extend(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&q.extend(c.prototype,a),c.__super__=d.prototype,c},q.isEmpty=function(a){if(null==a)return!0;if(q.isArray(a)||q.isString(a))return 0===a.length;for(var b in a)if(q.has(a,b))return!1;return!0},q.isArray=m||function(a){return"[object Array]"==h.call(a)},r(["Arguments","Function","String","Number","Date","RegExp"],function(a){q["is"+a]=function(b){return h.call(b)=="[object "+a+"]"}}),"function"!=typeof/./&&(q.isFunction=function(a){return"function"==typeof a}),q.pick=function(a){var b={},d=g.apply(c,f.call(arguments,1));return r(d,function(c){c in a&&(b[c]=a[c])}),b},q.has=function(a,b){return i.call(a,b)},q.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},q.keys=n||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)q.has(a,c)&&b.push(c);return b};var s=function(){};q.bind=function(a,b){var c,d;if(o&&a.bind===o)return o.apply(a,f.call(arguments,1));if(!q.isFunction(a))throw new TypeError;return c=f.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(f.call(arguments)));s.prototype=a.prototype;var e=new s;s.prototype=null;var g=a.apply(e,c.concat(f.call(arguments)));return Object(g)===g?g:e}},q.bindAll=function(a){var b=f.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return r(b,function(b){a[b]=q.bind(a[b],a)}),a},a._=q}(XO),function(a,b){var c={on:function(a,b,c){if(!e(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,c,d){if(!e(this,"once",a,[c,d])||!c)return this;var f=this,g=b.once(function(){f.off(a,g),c.apply(this,arguments)});return g._callback=c,this.on(a,g,d)},off:function(a,c,d){var f,g,h,i,j,k,l,m;if(!this._events||!e(this,"off",a,[c,d]))return this;if(!a&&!c&&!d)return this._events={},this;for(i=a?[a]:b.keys(this._events),j=0,k=i.length;k>j;j++)if(a=i[j],h=this._events[a]){if(this._events[a]=f=[],c||d)for(l=0,m=h.length;m>l;l++)g=h[l],(c&&c!==g.callback&&c!==g.callback._callback||d&&d!==g.context)&&f.push(g);f.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=Array.prototype.slice.call(arguments,1);if(!e(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&f(c,b),d&&f(d,arguments),this},stopListening:function(a,c,d){var e=this._listeningTo;if(!e)return this;var f=!c&&!d;d||"object"!=typeof c||(d=this),a&&((e={})[a._listenId]=a);for(var g in e)a=e[g],a.off(c,d,this),(f||b.isEmpty(a._events))&&delete this._listeningTo[g];return this}},d=/\s+/,e=function(a,b,c,e){if(!c)return!0;if("object"==typeof c){for(var f in c)a[b].apply(a,[f,c[f]].concat(e));return!1}if(d.test(c)){for(var g=c.split(d),h=0,i=g.length;i>h;h++)a[b].apply(a,[g[h]].concat(e));return!1}return!0},f=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},g={listenTo:"on",listenToOnce:"once"};b.each(g,function(a,d){c[d]=function(c,d,e){var f=this._listeningTo||(this._listeningTo={}),g=c._listenId||(c._listenId=b.uniqueId("evtListen"));return f[g]=c,e||"object"!=typeof d||(e=this),c[a](d,e,this),this}}),a.Events=c}(XO.Base,XO._),function(a,b){var c=function(){this.handlers=[],b.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},d=XO.$win,e=/^[#\/]|\s+$/g,f=/^\/+|\/+$/g,g=/msie [\w.]+/,h=/\/$/,i=/[?#].*$/;c.started=!1,b.extend(c.prototype,XO.Base.Events,{interval:50,getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(h,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(e,"")},start:function(a){if(c.started)throw new Error("XO.Base.History has already been started");c.started=!0,this.options=b.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var h=this.getFragment(),i=document.documentMode,j=g.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);this.root=("/"+this.root+"/").replace(f,"/"),j&&this._wantsHashChange&&(this.iframe=XO.$('<iframe id="if_XOHistoryHack" src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(h)),this._hasPushState?d.on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!j?d.on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=h;var k=this.location,l=k.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!l)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&l&&k.hash&&(this.fragment=this.getHash().replace(e,""),this.history.replaceState({},document.title,this.root+this.fragment+k.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){d.off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),c.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();return a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe))),a===this.fragment?!1:(this.iframe&&this.navigate(a),this.loadUrl(),void 0)},loadUrl:function(a){return a=this.fragment=this.getFragment(a),b.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!c.started)return!1;b&&b!==!0||(b={trigger:!!b});var d=this.root+(a=this.getFragment(a||""));if(a=a.replace(i,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==d&&(d=d.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,d);else{if(!this._wantsHashChange)return this.location.assign(d);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),c.extend=b.derive,a.History=c,a.history=new c}(XO.Base,XO._),function(a,b){var c=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},d=/\((.*?)\)/g,e=/(\(\?)?:\w+/g,f=/\*\w+/g,g=/[\-{}\[\]+?.,\\\^$|#\s]/g;b.extend(c.prototype,XO.Base.Events,{initialize:function(){},route:function(a,c,d){b.isRegExp(a)||(a=this._routeToRegExp(a)),b.isFunction(c)&&(d=c,c=""),d||(d=this[c]);var e=this;return XO.Base.history.route(a,function(b){var f=e._extractParameters(a,b);d&&d.apply(e,f),e.trigger.apply(e,["route:"+c].concat(f)),e.trigger("route",c,f),XO.Base.history.trigger("route",e,c,f)}),this},navigate:function(a,b){return XO.Base.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=b.result(this,"routes");for(var a,c=b.keys(this.routes);null!=(a=c.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(g,"\\$&").replace(d,"(?:$1)?").replace(e,function(a,b){return b?a:"([^/]+)"}).replace(f,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,c){var d=a.exec(c).slice(1);return b.map(d,function(a){return a?decodeURIComponent(a):null})}}),c.extend=b.derive,a.Router=c}(XO.Base,XO._),function(a,b){var c=function(a){this.cid=b.uniqueId("view"),a||(a={}),b.extend(this,b.pick(a,e)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},d=/^(\S+)\s*(.*)$/,e=["model","collection","el","id","attributes","className","tagName","events"];b.extend(c.prototype,XO.Base.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof XO.$?a:XO.$(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=b.result(this,"events")))return this;this.undelegateEvents();for(var c in a){var e=a[c];if(b.isFunction(e)||(e=this[a[c]]),e){var f=c.match(d),g=f[1],h=f[2];e=b.bind(e,this),g+=".delegateEvents"+this.cid,""===h?this.$el.on(g,e):this.$el.on(g,h,e)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(b.result(this,"el"),!1);else{var a=b.extend({},b.result(this,"attributes"));this.id&&(a.id=b.result(this,"id")),this.className&&(a["class"]=b.result(this,"className"));var c=XO.$("<"+b.result(this,"tagName")+">").attr(a);this.setElement(c,!1)}}}),c.extend=b.derive,a.View=c}(XO.Base,XO._),XO.CONST={CLASS:{ACTIVE:"current",UIACTIVE:"active",ANIMATION_IN:"in",ANIMATION_OUT:"out",ANIMATION_INMOTION:"inmotion",SUPPORT_3D:"supports3d",IOS5_AND_ABOVE:"ios5up",SUPPORT_TOUCHSCROLL:"touchscroll",SUPPORT_AUTOSCROLL:"autoscroll",ANIMATION_3D:"animating3d",ANIMATING:"animating",HIDE:"hide"},SELECTOR:{PAGE_WRAPPER:"body",DEFAULT_CSS_HOST:"body"},ATTR:{PAGE:"data-page",PAGE_SRC:"data-pagesrc",ANIMATION:"data-animate"},DEFAULT:{ANIMATION_NONE:"none",TEMPLATE_SUFFIX:"/",VIEW:"index",PAGE:"home",VIEW_ID_PREFIX:"xoview",DEFAULT_ACTION_PREFIX:"_"},ACTION:{PAGE:"page",SECTION:"section"}},XO("media",function(){window.matchMedia=window.matchMedia||function(a){"use strict";var b,c=a.documentElement,d=c.firstElementChild||c.firstChild,e=a.createElement("body"),f=a.createElement("div");return f.id="mq-test-1",f.style.cssText="position:absolute;top:-100em",e.style.background="none",e.appendChild(f),function(a){return f.innerHTML='&shy;<style media="'+a+'"> #mq-test-1 { width: 42px; }</style>',c.insertBefore(e,d),b=42===f.offsetWidth,c.removeChild(e),{matches:b,media:a}}}(document),this.test=function(a){return window.matchMedia(a).matches}}),XO("support",function(a,b){var c={supportForTransform3d:function(){var b,c,d,e="transform-3d",f=["Webkit","Moz","O"],g=a("<body id='XO-3DTEST'>").prependTo("html"),h=XO.media.test("(-"+f.join("-"+e+"),(-")+"-"+e+"),("+e+")");if(h)return!!h;b=document.createElement("div"),c={MozTransform:"-moz-transform",transform:"transform"},g.append(b);for(d in c)void 0!==b.style[d]&&(b.style[d]="translate3d( 100px, 1px, 1px )",h=window.getComputedStyle(b).getPropertyValue(c[d]));return g.parentNode.removeChild(g),!!h&&"none"!==h},supportIOS5:function(){var a=!1,b=/OS (\d+)(_\d+)* like Mac OS X/i,c=window.navigator.userAgent;return b.test(c)&&(a=b.exec(c)[1]>=5),a}};this.init=function(a){this.animationEvents="undefined"!=typeof window.WebKitAnimationEvent,this.touch="undefined"!=typeof window.TouchEvent&&window.navigator.userAgent.indexOf("Mobile")>-1&&XO.App.opts.useFastTouch,this.transform3d=c.supportForTransform3d(),this.ios5=c.supportIOS5(),this.touch||XO.warn("This device does not support touch interaction, or it has been deactivated by the developer. Some features might be unavailable."),this.transform3d||XO.warn("This device does not support 3d animation. 2d animations will be used instead.");var d=[];this.transform3d&&d.push(b.CLASS.SUPPORT_3D),a.useTouchScroll&&(this.ios5?d.push(b.CLASS.TOUCHSCROLL):d.push(b.CLASS.AUTOSCROLL)),XO.$body.addClass(d.join(" "))}}),XO("Event",function(a){this.on=function(b,c){return arguments.length<=2?(XO.$body.bind(b,c),void 0):(a(arguments[0]).bind(arguments[1],arguments[2]),void 0)},this.trigger=function(b,c){return arguments.length<=2?(XO.$body.trigger(b,c),void 0):(a(arguments[0]).trigger(arguments[1],arguments[2]),void 0)},this.init=function(){XO.EVENT.Sys={viewChange:"onorientationchange"in window?"orientationchange":"resize",fingerDown:XO.support.touch?"touchstart":"mousedown",fingerMove:XO.support.touch?"touchmove":"mousemove",fingerUp:XO.support.touch?"touchend":"mouseup"}}}),XO("plugin",function(a){var b=function(b,c){$el=b.length&&0!=b.length?b:a(b),this.$el=$el,this.dataset=c,this.plugin=c.plugin,this.pluginId=c.pluginId,this.init($el,c)};b.destroy=function(){this.$el.off("touchend"),this.$el.off("touchstart"),this.$el.off("touchmove"),this.$el.off("tab"),console.log("super destroy!")},b.init=function(){},b.bootup=function(){},b.initEvent=function(){},b.on=function(a,b){var c=this;XO.Event.on(this.$el,a+"-"+this.plugin,function(a,d){b.call(c,d)})},b.bind=function(){},b.trigger=function(a,b){XO.Event.trigger(this.$el,a+"-"+this.plugin,b)};var c={},d=0;this.get=function(a){return c[a]},this._show=function(){console.dir(c)},this.applyToView=function(a){this.applyToElement(a.$el)},this.applyToElement=function(a){var b;a.find("[data-plugin]").each(function(){var a=this.dataset;p_name=a.plugin,b=new XO.plugin[p_name](this,a),b.name=p_name,a.pluginId?c[a.pluginId]=b:(c["p_"+d]=b,d++)})},this.destroyInView=function(){},this.bootup=function(a,b){for(var c in b)plugin=this.get(c),plugin&&plugin.bootup(b[c])},this.define=function(a,c){c=c||{};var d=function(){b.apply(this,arguments),this.super=b,this.name=a};d.prototype=function(){var a=function(){};a.prototype=b;var d=new a;for(var e in c)d[e]=c[e];return d}(),XO.plugin[a]=d},this.init=function(){XO.Event.on(XO.EVENT.Animate.End,function(a,b){b.isHiding?XO.plugin.destroyInView(b.view):(XO.plugin.applyToView(b.view),XO.plugin.bootup(b.view,b.view.pluginData))})}}),XO("Controller",function(a){this.define=function(b,c){XO.Controller[b]=a.extend(XO.Controller[b]||{},{id:b,viewId:function(a){return XO.View.getId(b,a)},renderView:function(a,b){this.renderExternalView(this.id,a,b)},renderExternalView:function(b,c,d){d=a.extend({onRender:function(){},data:{},dataPointer:null,hardRefresh:!1,param:null},d||{});var e=XO.Controller.getFullActionName(b,c),f=d.onRender,g=d.data,h=a.isFunction(g);XO.View.switchTo(b,c,d.param,function(a,b,c){return a?(f(e+a),void 0):h?(g.call(d.dataPointer,d.param,function(a,d){c(a,d),f(a,b)}),void 0):(c(null,g),f(null,b),void 0)},d.hardRefresh)}},c||{})},this.getFullActionName=function(a,b,c){return"Controller."+a+"."+b+(c||":")},this.defineDefaultAction=function(a,b,c){var d={};d[XO.CONST.DEFAULT.DEFAULT_ACTION_PREFIX+b]=c||XO.App.opts.defaultControllerAction||function(a){this.renderView(b,{param:a,data:function(a,b){var c={hi:1};b(null,c)}})},this.define(a,d)},this.invoke=function(a,b,c){var d=XO.Controller[a][b]||XO.Controller[a][XO.CONST.DEFAULT.DEFAULT_ACTION_PREFIX+b];d.call(XO.Controller[a],c)}}),XO("View",function(a,b){this.exposeEvent(["Init","InitFromRemote","Inited","InitedTemplate","InitedTemplateError"]),this.caches={},this.curViews={},this.defaultActions={initialize:function(){this.isRendered=null===this.dir||"undefined"==typeof this.dir,this.isRemote=!this.isRendered&&-1!==this.dir.indexOf(b.DEFAULT.TEMPLATE_SUFFIX),this.$host=a(this.cssHost),XO.Event.trigger(XO.EVENT.View.Init,[this]),this.isRendered&&this.initFromDom()},initFromDom:function(){this.el=document.getElementById(this.id),this.$el=a(this.el),this.animation=this.animation||this.el.getAttribute[b.ATTR.ANIMATION]||XO.App.opts.defaultAnimation,XO.Event.trigger(this,XO.EVENT.View.Inited,[this]),this.onRender&&this.onRender.call(this)},initFromRemote:function(b){XO.Event.trigger(XO.EVENT.View.InitFromRemote,[this]);var c=XO.View.getLSKey(this.id),d=XO.LS[c],e=this;return this.isRemote?(this.src=this.dir+this.pid+"/"+this.vid+".html",d&&(d=JSON.parse(d))&&d.src===this.src&&d.version===this.version&&!XO.App.opts.debug?(this.tpl=d.tpl,XO.Event.trigger(XO.EVENT.View.InitedTemplate,[this]),b&&b(null,this),void 0):(a.ajax({url:this.src,cache:!1,success:function(a){e.tpl=a,XO.LS[c]=JSON.stringify({tpl:a,src:e.src,version:e.version}),XO.Event.trigger(XO.EVENT.View.InitedTemplate,[e]),b&&b(null,e)},error:function(a,c,d){XO.Event.trigger(XO.EVENT.View.InitedTemplateError,[e]),b&&b(c+d.toString())}}),void 0)):(this.tpl=document.getElementById(this.dir),XO.Event.trigger(XO.EVENT.View.InitedTemplate,[this]),b&&b(null,this),void 0)},render:function(a){var b=XO.toHtml(this.tpl,a);this.$host.prepend(b),this.isRendered=!0,this.initFromDom()},animateIn:function(a,b,c){XO.View.uiLoader.hide(),XO.Animate.animateIn(this,a,b)&&!c&&XO.View.setCurView(this,this.pid)},animateOut:function(a,b){XO.Animate.animateOut(this,a,b)}},this.define=function(c,d){return c=c||{},c.pid&&c.vid?(this.curViews[c.pid]=this.curViews[c.pid]||{},c.cssHost=c.cssHost||b.SELECTOR.DEFAULT_CSS_HOST,c.id=this.getId(c.pid,c.vid),c=a.extend(c,this.defaultActions),c.isInited=!1,this.caches[c.id]=c,d?this._init(c):void 0):(XO.warn("Parameters require! pid and vid required!"),!1)},this._init=function(a){XO.App&&XO.App.opts&&(a.dir=null===a.dir?null:XO.App.opts.viewDir);var b=XO.baseView.extend(a);return b.id=a.id,b=new b,b.init&&(b.init.call(b),delete b.init),b.isInited=!0,this.caches[b.id]=b,b.alias&&!this[b.alias]&&(this[b.alias]=b),XO.Controller.defineDefaultAction(b.pid,b.vid),b},this.get=function(a,b,c,d){var e=this.getId(a,b),f=this.caches[e];return f?f.isRendered?(c(null,f),void 0):d?(d.call(f,function(){f.initFromRemote(c)}),void 0):(f.initFromRemote(c),void 0):(c(XO.warn("View with id ["+e+"] not found!")),void 0)},this.getId=function(a,c){return[b.DEFAULT.VIEW_ID_PREFIX,a,c].join("-")},this.setCurView=function(a,b){b&&(this.curViews[b].curView=a),this.curViews.curView=a},this.getCurView=function(a){return a?this.curViews[a].curView:this.curViews.curView},this.switch=function(a,b,c,d,e){return d=d||!1,XO.Animate.switch(a,b,c,d)?(XO.View.setCurView(b,e),!0):!1},this.switchTo=function(a,b,c,d,e){var f=this.getCurView(),g=function(a,b){return a?(XO.warn("XO.View.switchTo:"+a),d(a),void 0):b.isRendered&&!e?(b.animateIn(c),void 0):(d(null,b,function(a,c){return a?(XO.warn("XO.View.switchTo:"+a),void 0):(b.render(c),b.animateIn({animation:"none"}),void 0)}),void 0)},h=function(a){XO.View.uiLoader.animateIn(c,{onEnd:a},!0)};f&&f.animateOut(c),this.get(a,b,g,h)},this.init=function(){for(var a in this.caches)this.caches[a].isInited||this._init(this.caches[a])}}),XO.View.define({pid:"common",vid:"mask",alias:"uiMask",dir:null,isMasking:!1,show:function(){this.isMasking||(this.isMasking=!0,this.$el.removeClass(XO.CONST.CLASS.HIDE))},hide:function(){this.$el.addClass(XO.CONST.CLASS.HIDE),this.isMasking=!1}}),XO.View.define({pid:"common",vid:"loader",alias:"uiLoader",dir:null,isLoading:!1,show:function(){this.isLoading||(this.isLoading=!0,this.$el.removeClass(XO.CONST.CLASS.HIDE))},hide:function(){this.$el.addClass(XO.CONST.CLASS.HIDE).removeClass(XO.CONST.CLASS.ACTIVE),this.isLoading=!1}}),XO.View.define({pid:"common",vid:"logger",alias:"uiLogger",dir:null,init:function(){this.$bd=this.$el.find(".xo_logger_bd")},log:function(a,b){return b=b||"null",this.$bd.append(b+':<div class="xo_logger_txt">'+a+"</div>"),this},show:function(){return this.$el.removeClass(XO.CONST.CLASS.HIDE),this},hide:function(){return this.$el.addClass(XO.CONST.CLASS.HIDE),this}}),XO("Router",function(a,b){this.defaultRouteIndex=1e3,this.init=function(c){var d=c.routes||{":page":"showPage",":page/:view":"showPage",":page/:view/:data":"showPage",":page/section/:section":"showSection",":page/section/:section/:param":"showSection",":page/aside/:aside":"showAside",":page/aside/:aside/:param":"showAside",":page/popup/:popup":"showPopup",":page/popup/:popup/:param":"showPopup","*actions":"defaultRoute"},e=XO.baseRouter.extend({routes:d,initialize:function(){this.on({route:this.onRoute,"route:defaultRoute":this.onDefaultRoute}),XO.$doc.on("click","a:not([data-notrouter])",function(b){var c=a(this).attr("href"),d=this.protocol+"//",e=XO.Router.instance.rIndex,f=null,g=!1;return XO.Router.instance.linkClicked=!0,XO.Router.instance.isGoback=!1,c&&c.slice(0,d.length)!==d&&0!==c.indexOf("javascript")?(b.preventDefault(),f=this.getAttribute("data-ridx"),f=f?parseInt(f)||0:XO.Router.defaultRouteIndex,g=this.getAttribute("data-back"),!g&&e>f&&(g=c),c=g||c,XO.Router.instance.isGoback=g,XO.Router.instance.rIndex=f,XO.history.navigate(c,!0),void 0):(XO.Router.instance.rIndex=XO.Router.defaultRouteIndex,void 0)}).on("click","button",function(){XO.Router.instance.linkClicked=!0,XO.Router.instance.isGoback=this.getAttribute("data-back"),XO.Router.instance.isGoback&&XO.history.navigate(XO.Router.instance.isGoback,!0)})},showPage:function(a,c,d){c=c||"index",d=JSON.parse(d||"{}");var e=this.linkClicked?null:b.DEFAULT.ANIMATION_NONE,f={pid:a,vid:c,animation:e,back:this.isGoback,dir:XO.App.opts.viewDir,type:b.ACTION.PAGE,cssHost:b.SELECTOR.PAGE_WRAPPER};f.params=d,XO.Controller.invoke(a,c,f),this.isGoback=!1,this.linkClicked=!1},showSection:function(a,b,c){console.log("showSection",{pid:a,secId:b,param:c})},showAside:function(a,b,c){console.log("showAside",{pid:a,asId:b,param:c})},showPopup:function(a,b,c){console.log("showPopup",{pid:a,popId:b,param:c})
},isGoback:!1,rIndex:-1,onRoute:function(a,b){console.log("onRoute",a,b)},onDefaultRoute:function(a){console.log("Intercepted call of default router: "+a)}});this.instance=new e}}),XO("Animate",function(a,b){this.exposeEvent(["Start","End"]),this.animations={cubeleft:{name:"cubeleft",is3d:!0},cuberight:{name:"cuberight",is3d:!0},dissolve:{name:"dissolve"},fade:{name:"fade"},flipleft:{name:"flipleft",is3d:!0},flipright:{name:"flipright",is3d:!0},pop:{name:"pop",is3d:!0},swapleft:{name:"swapleft",is3d:!0},swapright:{name:"swapright",is3d:!0},slidedown:{name:"slidedown"},slideright:{name:"slideright"},slideup:{name:"slideup"},slideleft:{name:"slideleft"},xo_ani_slideleft:{name:"xo_ani_slideleft",is3d:!0},none:{name:"none"}},this.getReverseAnimation=function(a){var b={up:"down",down:"up",left:"right",right:"left","in":"out",out:"in"};return b[a]||a},this.add=function(a){this.animations[a.name]=a},this.get=function(a){return this.animations[a]||this.animations[XO.App.opts.defaultAnimation]},this.unselect=function(c){return c?(c.removeClass(b.CLASS.UIACTIVE),c.find("."+b.CLASS.UIACTIVE).removeClass(b.CLASS.UIACTIVE),void 0):(a("."+b.CLASS.UIACTIVE).removeClass(b.CLASS.UIACTIVE),void 0)},this.makeActive=function(a){a.addClass(b.CLASS.UIACTIVE)},this.animateIn=function(c,d,e){function f(){var a=XO.App.opts.tapBuffer;XO.support.animationEvents&&h&&XO.App.opts.useAnimations?(j.unbind("webkitAnimationEnd",f),k&&j.removeClass(k),XO.$body.removeClass(b.CLASS.ANIMATING+" "+b.CLASS.ANIMATION_3D)):(k&&j.removeClass(k),a+=260),setTimeout(function(){j.removeClass(b.CLASS.ANIMATION_IN),window.scroll(0,0)},a),XO.Event.trigger(c,XO.EVENT.Animate.End,[m]),XO.Event.trigger(XO.EVENT.Animate.End,[m]),c.onAnimated&&c.onAnimated.call(c,m),e.onEnd&&e.onEnd.call(c)}var g=d.animation,h=this.get(g),i=d.back||!1,j=c.$el;d.animation=h.name,e=e||{},h=h.name!==b.DEFAULT.ANIMATION_NONE?h:null;var k,l,m={direction:b.CLASS.ANIMATION_IN,back:i,animation:h,view:c,isHiding:!1};return void 0===j||0===j.length?(this.unselect(),XO.warn("XO.Animate.animateIn:Target element is missing."),!1):j.hasClass(b.CLASS.ACTIVE)?(this.unselect(),XO.warn("XO.Animate.animateIn:You are already on the page you are trying to navigate to."),!1):(XO.View.uiLogger&&XO.View.uiLogger.log("animateIn:"+JSON.stringify(d),c.id),a(":focus").trigger("blur"),XO.Event.trigger(c,XO.EVENT.Animate.Start,[m]),c.onAnimating&&c.onAnimating.call(c,m),e.onStart&&e.onStart.call(c),XO.support.animationEvents&&h&&XO.App.opts.useAnimations?(!XO.support.transform3d&&h.is3d&&(XO.warn("XO.Animate.animateIn:Did not detect support for 3d animations, falling back to "+XO.App.opts.defaultAnimation+"."),h.name=XO.App.opts.defaultAnimation),k=h.name,l=h.is3d?" "+b.CLASS.ANIMATION_3D:"",i&&(k=k.replace(/left|right|up|down|in|out/,this.getReverseAnimation)),XO.warn("XO.Animate.animateIn: finalAnimationName is "+k+"."),j.on("webkitAnimationEnd",f),XO.$body.addClass(b.CLASS.ANIMATING+l),j.removeClass(b.CLASS.HIDE).addClass([k,b.CLASS.ANIMATION_IN,b.CLASS.ACTIVE].join(" "))):(j.removeClass(b.CLASS.HIDE).addClass([b.CLASS.ACTIVE,b.CLASS.ANIMATION_IN].join(" ")),f()),!0)},this.animateOut=function(a,c,d){function e(){var c=[j,b.CLASS.ANIMATION_OUT,b.CLASS.ANIMATION_INMOTION].join(" ");XO.support.animationEvents&&g&&XO.App.opts.useAnimations?(h.unbind("webkitAnimationEnd",e),h.removeClass(c),XO.$body.removeClass(b.CLASS.ANIMATING+" "+b.CLASS.ANIMATION_3D)):h.removeClass(c),XO.Animate.unselect(h),XO.Event.trigger(a,XO.EVENT.Animate.End,[l]),XO.Event.trigger(XO.EVENT.Animate.End,[l]),a.onAnimated&&a.onAnimated.call(a,l),d.onEnd&&d.onEnd.call(a)}var f=c.animation,g=this.get(f),h=a.$el,i=c.back||!1;c.animation=g.name,d=d||{},g=g.name!==b.DEFAULT.ANIMATION_NONE?g:null;var j,k,l={direction:b.CLASS.ANIMATION_OUT,back:i,animation:g,view:a,isHiding:!0};return void 0===h||0===h.length?(XO.warn("XO.Animate.animateOut:Target element is missing."),!1):(XO.View.uiLogger&&XO.View.uiLogger.log("animateOut:"+JSON.stringify(c),a.id),XO.Event.trigger(a,XO.EVENT.Animate.Start,[l]),a.onAnimating&&a.onAnimating.call(a,l),d.onStart&&d.onStart.call(a),XO.support.animationEvents&&g&&XO.App.opts.useAnimations?(!XO.support.transform3d&&g.is3d&&(XO.warn("XO.Animate.animateOut:Did not detect support for 3d animations, falling back to "+XO.App.opts.defaultAnimation+"."),g.name=XO.App.opts.defaultAnimation),j=g.name,k=g.is3d?" "+b.CLASS.ANIMATION_3D:"",i&&(j=j.replace(/left|right|up|down|in|out/,this.getReverseAnimation)),XO.warn("XO.Animate.animateOut: finalAnimationName is "+j+"."),h.bind("webkitAnimationEnd",e),XO.$body.addClass(b.CLASS.ANIMATING+k),h.removeClass(b.CLASS.ACTIVE).addClass([j,b.CLASS.ANIMATION_OUT,b.CLASS.ANIMATION_INMOTION].join(" "))):(h.removeClass(b.CLASS.ACTIVE),e()),!0)}}),XO("App",function(a,b){this.hideAddressBar=function(){window.scrollTo(0,0)},this.init=function(c){var d={compile:function(a){return{tpl:a,render:function(){return this.tpl}}}};this.opts=a.extend({T:window.Hogan||d,baseRouter:XO.Base.Router,history:XO.Base.history,baseView:XO.Base.View,useFastTouch:!0,useAnimations:!0,defaultAnimation:"slideleft",trackScrollPositions:!0,useTouchScroll:!0,tapBuffer:100,debug:!1,defaultPage:b.DEFAULT.PAGE,defaultView:b.DEFAULT.VIEW,defaultControllerAction:null,viewDir:XO.$body[0].getAttribute("data-viewdir")||"assets/html/"},c||{}),XO.T=this.opts.T,XO.baseRouter=this.opts.baseRouter,XO.history=this.opts.history,XO.baseView=this.opts.baseView,this.opts.useFastTouch&&FastClick.attach(document.body),delete this.init;for(var e in XO)XO[e].init&&XO[e].init.call(XO[e],this.opts),delete XO[e].init;window.addEventListener(XO.EVENT.Sys.viewChange,this.hideAddressBar),this.hideAddressBar(),XO.plugin.applyToElement(XO.$body),XO.history.start();var f=this.opts.defaultPage;window.location.hash.substring(1)||XO.Router.instance.navigate(f,{trigger:!0,replace:!0}),XO.support.touch&&window.addEventListener("touchstart",function(){XO.App.hideAddressBar()},!0)}});